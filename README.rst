APEs: Astropy Proposals for Enhancement
---------------------------------------

APEs are documents to address non-trivial enhancements that require discussion
and thought beyond a single Pull Request. This is intended to mirror the
long-standing Python Enhancement  Proposal process, but generally not quite as
formally. Normally a proposal goes through various phases of consideration.
Discussion is expected to take place using existing mechanisms (astropy-dev,
github, hangouts, etc), and eventually a decision is made regarding whether the
proposal should be accepted, rejected, or modified.

Accepted APEs
^^^^^^^^^^^^^

=== ================================================================ =========== ============
#     Title                                                          Date        DOI
=== ================================================================ =========== ============
0   `The Astropy Project Governance Charter`_                        2021-Feb-19 |APE 0 DOI|
1   `APE Purpose and Process`_                                       2013-Nov-08 |APE 1 DOI|
2   `Astropy Release Cycle and Version Numbering`_                   2013-Dec-11 |APE 2 DOI|
3   `Configuration`_                                                 2013-Dec-10 |APE 3 DOI|
4   `Astropy Setup Helpers`_                                         2014-Jun-28 |APE 4 DOI|
5   `Coordinates Subpackage Plan`_                                   2014-Jan-22 |APE 5 DOI|
6   `Enhanced Character Separated Values table format`_              2015-Jan-26 |APE 6 DOI|
7   `NDData Plan`_                                                   2014-Dec-17 |APE 7 DOI|
8   `Astropy Community Code of Conduct`_                             2015-May-04 |APE 8 DOI|
10  `Roadmap for Python 3-only support`_                             2016-Aug-22 |APE 10 DOI|
12  `Using Cookiecutter for the package-template`_                   2017-Mar-28 |APE 12 DOI|
13  `Vision for Astropy Spectroscopic Tools`_                        2017-Dec-12 |APE 13 DOI|
14  `A shared Python interface for World Coordinate Systems`_        2018-Feb-28 |APE 14 DOI|
15  `An Updated Model for the Affiliated Package Ecosystem`_         2018-May-14 |APE 15 DOI|
17  `A roadmap for package infrastructure without astropy-helpers`_  2019-Dec-12 |APE 17 DOI|
18  `Adopt NEP 29 for CPython and Numpy Version Support`_            2021-Dec-25 |APE 18 DOI|
=== ================================================================ =========== ============

.. _The Astropy Project Governance Charter: https://github.com/astropy/astropy-APEs/blob/main/APE0.rst
.. _APE Purpose and Process: https://github.com/astropy/astropy-APEs/blob/main/APE1.rst
.. _Astropy Release Cycle and Version Numbering: https://github.com/astropy/astropy-APEs/blob/main/APE2.rst
.. _Configuration: https://github.com/astropy/astropy-APEs/blob/main/APE3.rst
.. _Astropy Setup Helpers: https://github.com/astropy/astropy-APEs/blob/main/APE4.rst
.. _Coordinates Subpackage Plan: https://github.com/astropy/astropy-APEs/blob/main/APE5.rst
.. _Enhanced Character Separated Values table format: https://github.com/astropy/astropy-APEs/blob/main/APE6.rst
.. _NDData Plan: https://github.com/astropy/astropy-APEs/blob/main/APE7.rst
.. _Astropy Community Code of Conduct: https://github.com/astropy/astropy-APEs/blob/main/APE8.rst
.. _Roadmap for Python 3-only support: https://github.com/astropy/astropy-APEs/blob/main/APE10.rst
.. _Using Cookiecutter for the package-template: https://github.com/astropy/astropy-APEs/blob/main/APE12.rst
.. _Vision for Astropy Spectroscopic Tools: https://github.com/astropy/astropy-APEs/blob/main/APE13.rst
.. _A shared Python interface for World Coordinate Systems: https://github.com/astropy/astropy-APEs/blob/main/APE14.rst
.. _An Updated Model for the Affiliated Package Ecosystem: https://github.com/astropy/astropy-APEs/blob/main/APE15.rst
.. _A roadmap for package infrastructure without astropy-helpers: https://github.com/astropy/astropy-APEs/blob/main/APE17.rst
.. _Adopt NEP 29 for CPython and Numpy Version Support: https://github.com/astropy/astropy-APEs/blob/main/APE18.rst

.. |APE 0 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.4552791.svg
   :target: https://doi.org/10.5281/zenodo.4552791
   
.. |APE 1 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043886.svg
   :target: https://doi.org/10.5281/zenodo.1043886

.. |APE 2 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043888.svg
   :target: https://doi.org/10.5281/zenodo.1043888

.. |APE 3 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043890.svg
   :target: https://doi.org/10.5281/zenodo.1043890

.. |APE 4 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043892.svg
   :target: https://doi.org/10.5281/zenodo.1043892

.. |APE 5 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043897.svg
   :target: https://doi.org/10.5281/zenodo.1043897

.. |APE 6 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043901.svg
   :target: https://doi.org/10.5281/zenodo.1043901

.. |APE 7 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043907.svg
   :target: https://doi.org/10.5281/zenodo.1043907

.. |APE 8 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1043913.svg
   :target: https://doi.org/10.5281/zenodo.1043913

.. |APE 10 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1038587.svg
   :target: https://doi.org/10.5281/zenodo.1038587

.. |APE 12 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1044484.svg
   :target: https://doi.org/10.5281/zenodo.1044484

.. |APE 13 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1117943.svg
   :target: https://doi.org/10.5281/zenodo.1117943

.. |APE 14 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1188875.svg
   :target: https://doi.org/10.5281/zenodo.1188875

.. |APE 15 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.1246834.svg
   :target: https://doi.org/10.5281/zenodo.1246834

.. |APE 17 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.3572844.svg
   :target: https://doi.org/10.5281/zenodo.3572844
   
.. |APE 18 DOI| image:: https://zenodo.org/badge/DOI/10.5281/zenodo.4563083.svg
   :target: https://doi.org/10.5281/zenodo.4563083


Proposing a new APE
^^^^^^^^^^^^^^^^^^^

New APEs should be created using the ``APEtemplate.rst`` file in this repository.
Fork the repository, copy ``APEtemplate.rst`` to
``APE_<some_working_name>.rst`` and issue a Pull Request with that file once
you've written it up (little explanation is required in the PR itself given that
the document has all the content - usually it's easiest to just paste in the
abstract). The APE number will be assigned once the PR is merged.

Note that there is not much point to making proposals unless someone or some
group has signed up to implement it if the APE is accepted
(typically this would involve the author or authors of the APE).  Just issuing
an APE in order to spur others to do work is not generally going to be received
well. Generally, an implementation is expected before an APE can be considered
fully accepted. For proposals that require extensive work that few are willing
to perform without some assurance it will be accepted, provisional acceptance
is an option. For serious consideration it is usually good to show that detailed
technical aspects have been played with in real code rather (even if it isn't a
complete implementation).

Finalizing APEs
^^^^^^^^^^^^^^^

The final decision on accepting or rejecting APEs lies with the Astropy
Coordination Committee.  Once the community discussion on the APE has wound
down, the committee discusses the APE and makes a final decision on acceptance
or rejection.  One of the committee members should then:

1. Fill in the "Decision rationale" section of the APE with a description of why
   the APE was accepted or rejected, including a summary of the community's
   discussion as relevant.
2. Update the "date-last-revised" to the day of merging and "status" to
   "Accepted" or "Rejected".
3. If necessary, rename the APE file to be ``APE##.rst``, where ## is the next
   free number on the list of APEs.
#. Leave a brief comment in the PR indicating the result.
#. Merge the PR with the above changes.
#. If the APE was accepted then continue with the remaining steps, otherwise stop now.
#. Upload the APE to Zenodo to give it a DOI.  Go to https://zenodo.org/deposit/new, upload
   the .rst file, and set the fields to the following:

   ============================= ======================================================
   Zenodo field                  Set to
   ============================= ======================================================
   Communities                   The Astropy Project
   Upload type                   Publication
   Publication type              Technical note
   Publication Date              The date-last-revised of the APE (which should be the same as the accepted date for new APEs)
   Title                         Astropy Proposal for Enhancement <number>: <title> (APE <number>)
   Authors                       The APE authors (directly from the APE text, but with ORCIDs if possible)
   Description                   The APE abstract (copy/paste the rendered HTML from GitHub)
   License                       CC-Attribution (default)
   Related/alternate identifiers Github link to the APE file *at the specific merge commit* (e.g. https://github.com/astropy/astropy-APEs/blob/42951733ac42c0ea178d8df30705274a43c93091/APE1.rst) as "is supplemented by this upload". If this is a revised version, this should be the URL of the commit where the APE was revised.
   ============================= ======================================================

#. Get the source for the DOI badge from the newly-created Zenodo record page by
   clicking on the DOI badge on the right side of the page and copying the
   reStructuredText source.
#. On GitHub (or locally) edit ``README.rst`` and add an entry for the new APE to the
   "Accepted APEs" table.  Use the DOI link from the previous step.  Add
   corresponding RST link refs for both the DOI link and the new APE.  Preview
   the update and test the links to make sure they are all correct.  Then commit
   directly to main (or PR if you prefer).
#. Send an email to `astropy-dev <https://groups.google.com/forum/#!forum/astropy-dev/>`_
   announcing the acceptance In general this should just point to the accepted
   APE rather than providing additional decision rationale.

Updating APEs
^^^^^^^^^^^^^

In the cases where an updated APE requires updating (e.g. references to a  new
APE that supercedes it, clarifying information that emerges after the APE is
accepted, etc.), changes can be made directly via PR, but the
"date-last-revised" should be updated in the APE. Additionally, the Zenodo entry
will need to be updated with a new version of the APE (*not* a completely new
Zenodo entry), by using the "New version" button and then filling out the forms
as described above.
